<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>丹田呼吸 V6</title>
    <style>
        body { font-family: sans-serif; background: #f0f4f8; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: white; padding: 30px; border-radius: 20px; text-align: center; width: 85%; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .timer { font-size: 5rem; font-weight: bold; margin: 20px 0; }
        .status { font-size: 2rem; color: #3498db; min-height: 3rem; }
        button { background: #2ecc71; color: white; border: none; padding: 20px; font-size: 1.5rem; border-radius: 50px; width: 100%; cursor: pointer; }
        button:active { background: #27ae60; transform: scale(0.98); }
    </style>
</head>
<body>
    <div class="box">
        <h2 id="msg">丹田呼吸訓練</h2>
        <div class="status" id="st">準備開始</div>
        <div class="timer" id="tm">00</div>
        <button id="btn" onclick="start()">開始練習</button>
    </div>
<script>
    const synth = window.speechSynthesis;
    function speak(txt, cb) {
        synth.cancel();
        const u = new SpeechSynthesisUtterance(txt);
        u.lang = 'zh-TW';
        u.onend = () => { if(cb) cb(); };
        synth.speak(u);
        if(cb) setTimeout(cb, txt.length * 400 + 1000);
    }
    function start() {
        document.getElementById('btn').disabled = true;
        document.getElementById('btn').innerText = "練習中...";
        speak("丹田呼吸，15秒10組練習。3。2。1。", () => {
            inhale();
        });
    }
    function inhale() {
        document.getElementById('st').innerText = "吸氣";
        speak("吸氣", () => count(15, "exhale"));
    }
    function exhale() {
        document.getElementById('st').innerText = "吐氣";
        speak("吐氣", () => count(15, "inhale"));
    }
    function count(s, next) {
        let c = s;
        const iv = setInterval(() => {
            document.getElementById('tm').innerText = c < 10 ? '0'+c : c;
            if(c <= 0) {
                clearInterval(iv);
                if(next === "exhale") exhale();
                else inhale();
            }
            c--;
        }, 1000);
    }
</script>
</body>
</html>
